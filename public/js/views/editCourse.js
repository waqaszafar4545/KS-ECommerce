var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(f){var g=0;return function(){return g<f.length?{done:!1,value:f[g++]}:{done:!0}}};$jscomp.arrayIterator=function(f){return{next:$jscomp.arrayIteratorImpl(f)}};$jscomp.makeIterator=function(f){var g="undefined"!=typeof Symbol&&Symbol.iterator&&f[Symbol.iterator];return g?g.call(f):$jscomp.arrayIterator(f)};
$(function(){function f(b,c,a){b=void 0===b?null:b;c=void 0===c?null:c;a='<div data-sort-id="'+(void 0===a?null:a)+'" class="module-row-wrapper" data-id="'+d+'"><div class="row mb-1"><div class="col-1"><i class="fas fa-2x fa-arrows-alt module-dragger"></i></div><div class="col-4"><div class="form-group pd-w-100">';a+='<input data-db-module-id="'+b+'" placeholder="Enter Module Name" type="text" data-module-id="'+d+'" id="module-selector-'+d+'" class="form-control"></div></div><div class="col-7"><div class="accordion" id="accordionExample">';
a=a+'<div class="card"><div class="card-header" id="headingOne"><h2 class="mb-0"><button class="btn btn-link" type="button" data-toggle="collapse"data-target="#collapse-'+(d+'" aria-expanded="true" aria-controls="collapse-'+d+'">Click to view videos</button>');a+='<button data-module-id="'+d+'" class="btn btn-primary add-videos-btn float-right" type="button">Add Videos</button></h2>';a+='</div><div id="collapse-'+d+'" class="collapse hide" aria-labelledby="headingOne"';a+='data-parent="#accordionExample"><div class="card-body" id="accordion-card-body-'+
d+'">No Videos';a+="</div></div></div></div></div></div><br/></div>";$("#course-modules-wrapper").append(a);c&&$("#module-selector-"+d).val(c);e[d]={dbModuleId:b,moduleName:c,videos:[]};b=document.getElementById("course-modules-wrapper");Sortable.create(b,{handle:".module-dragger",ghostClass:"list-group-item-info"});d++}function g(b,c){var a="<ul class='list-group sortable-videos-list-wrapper' id='sortable-list-"+c+"'>";b.forEach(function(b){a+="<li data-sort-id='"+b.sort_id+"' data-id='"+b.id+"' class='list-group-item'><i class='fas fa-video mx-2'></i>"+
b.title+"-"+b.duration+"<button data-video-id='"+b.id+"' data-module-id='"+c+"' class='btn btn-danger btn-sm float-right video-remove-btn' type='button'>Remove</button></li>";k.push(b.id)});e[c].videos=JSON.parse(JSON.stringify(b));a+="</ul>";$("#accordion-card-body-"+c).empty().html(a);var d=document.getElementById("sortable-list-"+c);Sortable.create(d,{ghostClass:"list-group-item-info"});l("data-sort-id","#sortable-list-"+c,"li","asc")}function l(b,c,a,e){c=$(c);a=c.children(a);a.sort(function(a,
c){var d=parseInt(a.getAttribute(b)),f=parseInt(c.getAttribute(b));if("asc"==e){if(d>f)return 1;if(d<f)return-1}else if("desc"==e){if(d<f)return 1;if(d>f)return-1}return 0});a.detach().appendTo(c)}function m(){$(".video-add-checkbox").each(function(b,c){$(c).prop("checked",!1)})}var d=1,e={},h=null,k=[],n=$("#uploaded-cover-image-name").data("url"),p=$("#uploaded-thumbnail-image-name").data("url");JSON.parse($("#course_videos_and_modules").val()).forEach(function(b){f(b.id,b.name,b.sort_id);g(b.videos,
d-1)});l("data-sort-id","#course-modules-wrapper",".module-row-wrapper","asc");$("input[name='is_free']").click(function(){1==$(this).prop("checked")?($("input[name='price'],input[name='discount']").prop("disabled",!0),$("input[name='price'],input[name='discount']").removeAttr("required"),$("#free-video-details").removeClass("d-none"),$("#paid-video-details").addClass("d-none")):0==$(this).prop("checked")&&($("input[name='price'],input[name='discount']").prop("disabled",!1),$("input[name='price'],input[name='discount']").prop("required",
!0),$("#free-video-details").addClass("d-none"),$("#paid-video-details").removeClass("d-none"))});$("#course-cover-image-uploader").fileinput({uploadUrl:$("#course-cover-image-uploader").attr("data-upload-url"),theme:"explorer-fas",browseOnZoneClick:!0,showUpload:!1,showCancel:!1,showRemove:!1,validateInitialCount:!1,browseLabel:"Select Image",allowedFileExtensions:["jpg","png","jpeg"],fileActionSettings:{showUpload:!1,showZoom:!0,showDrag:!1},uploadExtraData:{type:"cover_image"},overwriteInitial:!1,
initialPreview:[n],initialPreviewAsData:!0,initialPreviewShowDelete:!1,initialPreviewConfig:[]}).on("fileuploaded",function(b,c,a,d){$("#uploaded-cover-image-name").val(c.response.uploadedFileName);0<$("#course-thumbnail-image-uploader").fileinput("getFilesCount")?$("#course-thumbnail-image-uploader").fileinput("upload"):$("#update-course-form").submit()});$("#course-thumbnail-image-uploader").fileinput({uploadUrl:$("#course-thumbnail-image-uploader").attr("data-upload-url"),theme:"explorer-fas",
browseOnZoneClick:!0,showUpload:!1,showCancel:!1,showRemove:!1,validateInitialCount:!1,browseLabel:"Select Image",allowedFileExtensions:["jpg","png","jpeg"],fileActionSettings:{showUpload:!1,showZoom:!0,showDrag:!1},uploadExtraData:{type:"thumbnail_image"},overwriteInitial:!1,initialPreview:[p],initialPreviewAsData:!0,initialPreviewShowDelete:!1,initialPreviewConfig:[]}).on("fileuploaded",function(b,c,a,d){$("#uploaded-thumbnail-image-name").val(c.response.uploadedFileName);$("#update-course-form").submit()});
$("#submit-update-course-btn").click(function(b){b=$(".module-row-wrapper").map(function(){return $(this).data("id")}).get();for(var c=$jscomp.makeIterator(Object.keys(e)),a=c.next();!a.done;a=c.next()){a=a.value;var d=[];0==e[a].videos.length?delete e[a]:(e[a].moduleName=$("#module-selector-"+a).val(),$("#sortable-list-"+a).each(function(){d=$(this).find("li[data-id]").map(function(){return $(this).data("id")}).get()}),e[a].videos.map(function(a){a.sort_id=d.indexOf(a.id)}),e[a].sort_id=b.indexOf(Number(a)))}$("input[name='selected_videos_and_modules']").val(JSON.stringify(e));
$("#update-course-form").parsley().validate();$("#update-course-form").parsley().isValid()&&(0<$("#course-cover-image-uploader").fileinput("getFilesCount")?$("#course-cover-image-uploader").fileinput("upload"):0==$("#course-cover-image-uploader").fileinput("getFilesCount")&&0<$("#course-thumbnail-image-uploader").fileinput("getFilesCount")?$("#course-thumbnail-image-uploader").fileinput("upload"):$("#update-course-form").submit())});$(document).on("click","#add-to-module-btn",function(){var b=[];
0<e[h].videos.length&&(b=JSON.parse(JSON.stringify(e[h].videos)));$(".video-add-checkbox").each(function(c,a){$(a).prop("checked")&&b.push({id:Number($(a).val()),title:$(a).data("video-title"),duration:$(a).data("video-duration")})});0<b.length?($("#selectVideosModal").modal("toggle"),g(b,h)):toastr.warning("Please select some videos.","Warning")});$("#clear-all-checkboxes-btn").click(function(){m()});$(document).on("click",".add-videos-btn",function(){k=[];h=$(this).data("module-id");if($("#module-selector-"+
h).val()){for(var b=$jscomp.makeIterator(Object.keys(e)),c=b.next();!c.done;c=b.next())e[c.value].videos.forEach(function(a){k.push(a.id)});$(".select-video-row").show();m();k.forEach(function(a){$("#select-video-row-"+a).hide()});$("#selectVideosModal").modal("toggle")}else toastr.warning("Please enter module name first.","Warning")});$(document).on("click",".video-remove-btn",function(){var b=$(this).data("video-id"),c=$(this).data("module-id"),a=$.grep(e[c].videos,function(a){return a.id!=b});
e[c].videos=a;g(e[c].videos,c)});$("#add-more-module-btn").click(function(){f()});$(".video-preview-btn").click(function(){$("#videoPreviewModal .modal-title").text($(this).data("video-title"));var b=$(this).data("file-name");("free"==$(this).data("video-value")?videojs("video-player",{controls:!0,autoplay:!1,preload:"auto",fluid:!0,techOrder:["youtube"],sources:[{type:"video/youtube",src:b}],youtube:{iv_load_policy:1}}):videojs("video-player",{controls:!0,autoplay:!1,preload:"auto",fluid:!0})).src(b);
$("#videoPreviewModal").modal("toggle")});$("#videoPreviewModal").on("hidden.bs.modal",function(){$("#videoPreviewModal .modal-title").empty();videojs("video-player").dispose();$("#videoPreviewModal .modal-body").append('<video id="video-player" class="video-js vjs-default-skin vjs-big-play-centered">Your browser does not support HTML5 video.</video>')})});
